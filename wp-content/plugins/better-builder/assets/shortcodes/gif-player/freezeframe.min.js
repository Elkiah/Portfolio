(function(){"use strict";function e(){}function t(e,t){for(var i=e.length;i--;)if(e[i].listener===t)return i;return-1}function i(e){return function(){return this[e].apply(this,arguments)}}var n=e.prototype,s=this,r=s.EventEmitter;n.getListeners=function(e){var t,i,n=this._getEvents();if(e instanceof RegExp){t={};for(i in n)n.hasOwnProperty(i)&&e.test(i)&&(t[i]=n[i])}else t=n[e]||(n[e]=[]);return t},n.flattenListeners=function(e){var t,i=[];for(t=0;t<e.length;t+=1)i.push(e[t].listener);return i},n.getListenersAsObject=function(e){var t,i=this.getListeners(e);return i instanceof Array&&((t={})[e]=i),t||i},n.addListener=function(e,i){var n,s=this.getListenersAsObject(e),r="object"==typeof i;for(n in s)s.hasOwnProperty(n)&&-1===t(s[n],i)&&s[n].push(r?i:{listener:i,once:!1});return this},n.on=i("addListener"),n.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},n.once=i("addOnceListener"),n.defineEvent=function(e){return this.getListeners(e),this},n.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},n.removeListener=function(e,i){var n,s,r=this.getListenersAsObject(e);for(s in r)r.hasOwnProperty(s)&&-1!==(n=t(r[s],i))&&r[s].splice(n,1);return this},n.off=i("removeListener"),n.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},n.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},n.manipulateListeners=function(e,t,i){var n,s,r=e?this.removeListener:this.addListener,o=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(n=i.length;n--;)r.call(this,t,i[n]);else for(n in t)t.hasOwnProperty(n)&&(s=t[n])&&("function"==typeof s?r.call(this,n,s):o.call(this,n,s));return this},n.removeEvent=function(e){var t,i=typeof e,n=this._getEvents();if("string"===i)delete n[e];else if(e instanceof RegExp)for(t in n)n.hasOwnProperty(t)&&e.test(t)&&delete n[t];else delete this._events;return this},n.removeAllListeners=i("removeEvent"),n.emitEvent=function(e,t){var i,n,s,r,o=this.getListenersAsObject(e);for(r in o)if(o.hasOwnProperty(r))for(s=(i=o[r].slice(0)).length;s--;)!0===(n=i[s]).once&&this.removeListener(e,n.listener),n.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},n.trigger=i("emitEvent"),n.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},n.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},n._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},n._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return s.EventEmitter=r,e},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:s.EventEmitter=e}).call(this),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter"],function(i){return t(e,i)}):"object"==typeof module&&module.exports?module.exports=t(e,require("wolfy87-eventemitter")):e.imagesLoaded=t(e,e.EventEmitter)}(window,function(e,t){function i(e,t){for(var i in t)e[i]=t[i];return e}function n(e){var t=[];if(Array.isArray(e))t=e;else if("number"==typeof e.length)for(var i=0;i<e.length;i++)t.push(e[i]);else t.push(e);return t}function s(e,t,r){if(!(this instanceof s))return new s(e,t,r);"string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=n(e),this.options=i({},this.options),"function"==typeof t?r=t:i(this.options,t),r&&this.on("always",r),this.getImages(),a&&(this.jqDeferred=new a.Deferred),setTimeout(function(){this.check()}.bind(this))}function r(e){this.img=e}function o(e,t){this.url=e,this.element=t,this.img=new Image}var a=e.jQuery,c=e.console;s.prototype=Object.create(t.prototype),s.prototype.options={},s.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},s.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),!0===this.options.background&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&h[t]){for(var i=e.querySelectorAll("img"),n=0;n<i.length;n++){var s=i[n];this.addImage(s)}if("string"==typeof this.options.background){var r=e.querySelectorAll(this.options.background);for(n=0;n<r.length;n++){var o=r[n];this.addElementBackgroundImages(o)}}}};var h={1:!0,9:!0,11:!0};return s.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(t.backgroundImage);null!==n;){var s=n&&n[2];s&&this.addBackground(s,e),n=i.exec(t.backgroundImage)}},s.prototype.addImage=function(e){var t=new r(e);this.images.push(t)},s.prototype.addBackground=function(e,t){var i=new o(e,t);this.images.push(i)},s.prototype.check=function(){function e(e,i,n){setTimeout(function(){t.progress(e,i,n)})}var t=this;this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?this.images.forEach(function(t){t.once("progress",e),t.check()}):this.complete()},s.prototype.progress=function(e,t,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emit("progress",this,e,t),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&c&&c.log("progress: "+i,e,t)},s.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emit(e,this),this.emit("always",this),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},r.prototype=Object.create(t.prototype),r.prototype.check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src)},r.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},r.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("progress",this,this.img,t)},r.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},r.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},r.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},r.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},o.prototype=Object.create(r.prototype),o.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},o.prototype.unbindEvents=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this)},o.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("progress",this,this.element,t)},s.makeJQueryPlugin=function(t){(t=t||e.jQuery)&&((a=t).fn.imagesLoaded=function(e,t){return new s(this,e,t).jqDeferred.promise(a(this))})},s.makeJQueryPlugin(),s});var freezeframe=function(e){function t(e){var t;if(this.options={selector:".freezeframe",animation_play_duration:5e3,non_touch_device_trigger_event:"hover",overlay:!1},t="string"==typeof e?{selector:e}:e)for(attribute in t)attribute in this.options?this.options[attribute]=t[attribute]:n(attribute+" not a valid option");this.is_touch_device="ontouchstart"in window||"onmsgesturechange"in window}var n=function(e){console.warn("✨ freezeframe.js ✨ : "+e)},s=function(){return 0!=this.images.length},r=function(t,i){var s;if(void 0!=t&&i.length>1){if(0==(s=i.filter(e(t))).length)return n("no images found for selector '"+t+"'"),!1}else s=i;return s},o=function(t){var i=t.siblings("canvas"),n="transitionend webkitTransitionEnd oTransitionEnd otransitionend",s=t[0].clientWidth,r=t[0].clientHeight;i.attr({width:s,height:r}),context=i[0].getContext("2d"),context.drawImage(t[0],0,0,s,r),i.addClass("ff-canvas-ready").on(n,function(){e(this).off(n),t.addClass("ff-image-ready")})};return t.prototype.capture=function(t){var s;if(void 0!==t)s=t;else{if(void 0===this.options.selector)return n("no selector passed to capture function or set in options"),!1;s=this.options.selector}for(void 0==this.images&&(this.images=e()),this.images=this.images.add(e("img"+s)),i=0;i<this.images.length;i++)"gif"!==this.images[i].src.split(".").pop().toLowerCase().substring(0,3)&&this.images.splice(i,1);return 0==this.images.length?(console.warn('freezeframe : no gifs found for selector "'+s+'"'),!1):this},t.prototype.setup=function(t){if(void 0!=t){var i=t.selector;t.overlay}var a=this,c=this.images.not(".ff-setup"),h=["ff-container"];return s.call(a)?0==c.length?(n("unable to run setup(), no images require setup"),!1):(r.call(a,i,c).each(function(t){var i=e(this);i.addClass("ff-setup ff-image"),i.hasClass("freezeframe-responsive")&&h.push("ff-responsive"),$canvas=e("<canvas />",{class:"ff-canvas"}).attr({width:0,height:0}).insertBefore(i),i.add($canvas).wrapAll(e("<div />",{class:h.join(" ")})),a.options.overlay&&($overlay=e("<div />",{class:"ff-playpause"}).insertAfter(i),$overlay.click(function(t){t.preventDefault(),e(this).toggleClass("ff-playing"),a.trigger(i)}))}),imagesLoaded(c).on("progress",function(t,i){o.call(a,e(i.img))}),this):(n("unable to run setup(), no images captured"),!1)},t.prototype.attach=function(t){var i=this;return s.call(i)?(r.call(i,t,i.images).each(function(t){var n=e(this),s=e(this).siblings("canvas"),r=e(this).siblings(".ff-playpause");if(i.options.overlay||(i.is_touch_device||"hover"!=i.options.non_touch_device_trigger_event)&&!i.is_touch_device||(n.mouseenter(function(){n.hasClass("ff-image-ready")&&(n.attr("src",n[0].src),s.removeClass("ff-canvas-ready").addClass("ff-canvas-active"))}),n.mouseleave(function(){n.hasClass("ff-image-ready")&&s.removeClass("ff-canvas-active").addClass("ff-canvas-ready")})),i.options.overlay||!i.is_touch_device&&"click"==i.options.non_touch_device_trigger_event||i.is_touch_device){var o;n.click(function(){!function(){var t=s.hasClass("ff-canvas-active");n.hasClass("ff-image-ready")&&(t?(i.options.animation_play_duration!=1/0&&clearTimeout(o),s.removeClass("ff-canvas-active").addClass("ff-canvas-ready"),e(r).toggleClass("ff-playing")):(n.attr("src",n[0].src),s.removeClass("ff-canvas-ready").addClass("ff-canvas-active"),i.options.animation_play_duration!=1/0&&(o=setTimeout(function(){s.removeClass("ff-canvas-active").addClass("ff-canvas-ready")},i.options.animation_play_duration)),e(r).toggleClass("ff-playing")))}()})}}),this):(n("unable to run attach(), no images captured"),!1)},t.prototype.trigger=function(t){var i=this,s=0;return r.call(i,t,i.images).each(function(t){e(this).hasClass("ff-image-ready")?(e(this).attr("src",e(this)[0].src),e(this).siblings("canvas").removeClass("ff-canvas-ready").addClass("ff-canvas-active")):(n("image not done processing ! "+e(this).attr("src")),s++)}),0==s},t.prototype.release=function(t){var i=this,s=0;return r.call(i,t,i.images).each(function(t){e(this).hasClass("ff-image-ready")?e(this).siblings("canvas").removeClass("ff-canvas-active").addClass("ff-canvas-ready"):(n("image not done processing ! "+e(this).attr("src")),s++)}),0==s},t.prototype.freeze=function(){return this.capture().setup().attach(),this},t}(jQuery);jQuery.fn.freezeframe=function(e){if(0==this.length)return console.warn("✨ freezeframe.js ✨ : no images found for selector "+this.selector),!1;var t=new freezeframe(e);t.images=this,t.setup().attach();var i=this;return["trigger","release"].forEach(function(e){i[e]=function(){return t[e](i.selector),i}}),this};